
 BerkeleyGW version 4.0+git 8511836-dirty by Jacob Clary <jacl0659@ed1.ib0.cm.hpc.nrel.gov> at 2024-03-13 16:03:19 -0600
 Epsilon code, Complex version, run on 09-Aug-2025 at 06:12:09 -0600

                                                                 ..o.          
                                                                .oxxo.         
                                                               .oxxxxo...      
                                                               oxxxxxxo.       
                                                              .oxxxxxxx.       
                                                              .ooooooxxo..     
                                                              .oooooooxo..     
                                                              .oooooxxo...     
                                                       .........oxooo......    
                                                 ............................  
                                             ................................. 
                                          .................................... 
           .          ..oo. ....  .................................oooxxxxxxxo.
     .............oxxxx@ox@@@x@x.....................o...........ooooooooooxx. 
    .o.........oox@x.oo........xxx@@............ooxxxxo..........ooooxxxxxoxo  
    .x........x@xxo...............o@xxo........oxxx@@@xoooooooooooooooxxxo...  
    .o......ox@@o..................oox@o.....ooxxx@xoooxxxxxxxoooooooooooo.... 
    o..ooooo@@xoooo....ooo...........x@o.....ooxxxxo   .oxxxxxxxxxxooooooo.... 
    . .oooo@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@....ooooox.     .oxx@@@@@xxoo........ 
      .ooooxxxxxxxooooooxooooooooooooooxo...oooooxx.        ..ox@xxxoo.........
      .ooooooxxxx@xoooooooooooooxxoooooooooooxxxxx.            .oxxooooooooxxo.
     .oooooxxxxx@@@xxxxxxxxxxxxxxxxxxxxxxxxoxxxxo.                .oxxxxxxxxo. 
   ....oooxxxxx@@@xo..oxxx@@@@@@xxxxoxxoooooooxx.                  .oxxxoo..   
  .....ooxxxx@@xo.       ........    .ooooooooxxo                              
  ..oooxxxx@@@o                       .oooooooxoo.                             
  ....oxooxxxxx.                       .ooo..oooo.                             
  .....o.ooxxxxxo.                     .oooooooxo.                             
 ......ooooxxxxxxo.                     .ooooooxoo..                           
........ooxxxxxxxo..                     .o....oxoo...                         
.......ooooxxxxxxxo.                     ........oooo.                         
.ooooooo..ooxxxxoooo.                    .........ooo...                       
..oxo...ooooxxxoooo..                    .ooo......oooo...                     
  .ooooo....o.                            .oxxxoo....ooo....                   
    .oooooo...                              ...ooooo...ooo..                   
       ...                                     .oo.......                      
                                               ....ooo...                      
                      __              __                                       
 ______              [  |            [  |                 ._____  _          _ 
|_   _               | |  _          | |                /  ___ | |        | |
  | |_) | .---.  _. _.| | / |  .---.  | | .---.  _    _ / /    _|   /  / / 
  |  __'./ /__\[ /`_| '' <  / /__\ | |/ /__\|   | | |   _____  /  / /  
 _| |__| | __. | |   | |`  | ___. | || ___.  / /  .___| |    /  /   
|_______/ .__./[_]  [__|  _] .__./[___].__./    /   .____./    /  /    
                                                  / /                          
                                                 /_/                           
 --------------------------------------------------------------------------------
 Please cite the main BerkeleyGW paper when using results from this calculation:

 Jack Deslippe, Georgy Samsonidze, David A. Strubbe, Manish Jain, Marvin L.
 Cohen, and Steven G. Louie, "BerkeleyGW: A Massively Parallel Computer Package
 for the Calculation of the Quasiparticle and Optical Properties of Materials
 and Nanostructures," Comput. Phys. Commun. 183, 1269 (2012)

 Aditionally, PLEASE CITE ALL PAPERS REPORTED AT THE END OF THIS CALCULATION.
 --------------------------------------------------------------------------------

 Running MPI version (parallel)
 Running with 256 MPI task(s)
 Using OpenMP. Number of threads per MPI task: 32
 Number of threads used for sorting routines: 1

 Compilation flags:
 - Compiler: NVHPC
 - Para. flags: MPI, OMP
 - Math  flags: USESCALAPACK, UNPACKED, USEFFTW3, HDF5
 - Debug flags: 

 Running with verbosity level 1 (default).

 We will start a new calculation from scratch.

 Experimental Features:
  - FFTs Optimization Level: 0
  - Use HDF5 Parallel IO: T

 
 We`ll perform a uniform sampling of the full BZ.
 
 Computing the static inverse dielectric matrix

 We are using matrix communication scheme

 We are using non-blocking cyclic communication scheme

 Using block algorithm over valence bands

 We are communicating via MPI

 We are using no truncation
 Reading header of WFN.h5
 Highest occupied band (unshifted grid) = 1996
 Valence max    (unshifted grid) = 6.233852 eV
 Conduction min (unshifted grid) = 6.597934 eV
 Middle energy  (unshifted grid) = 6.415893 eV
 Fermi  energy  (unshifted grid) = 6.415893 eV

 Reading header of WFNq.h5
 Highest occupied band (shifted grid) = 1996

 Calculation parameters:
 - Cutoff of the dielectric matrix (Ry): 8.00
 - Total number of bands in the calculation: 29346
 - Number of fully occupied valence bands: 1996
 - Number of partially occ. conduction bands: 0
 - Monkhorst-Pack q-grid for epsilon(q): 1 1 1
 
 Running with 8 valence pools
 Number of conduction bands per processor: 855
 Number of valence bands per processor: 250

 Memory available: 111996.5 MB per PE
 Memory required for execution: 45741.9 MB per PE
 Memory required for vcoul: 0.0 MB per PE

 Valence block alogorithm info
 Max memory allowed per valence block (Gb):    80.00
 Memory for a single valence band (Gb):         1.41
 Number of valence bands per block:              56

 Number of electrons per unit cell (from ifmax) = 3992.000000
 Number of electrons per unit cell (from occupations) = 3992.000000
 Plasma Frequency = 1.218925 Ry

 Reading using H5FD_MPIO_INDEPENDENT.
 Using communication style:  1
 
 Reading using H5FD_MPIO_INDEPENDENT.
 Using communication style:  1
 
 Initializing eps0mat.h5
 - Screened Coulomb cutoff: 8.000 Ry
 - Total number of bands: 29346
 - Number of q-points: 1

 Scissors parameters:
 - Valence:    es =   0.0000 eV, e0 =   0.0000 eV, edel =   0.0000
 - Conduction: es =   0.0000 eV, e0 =   0.0000 eV, edel =   0.0000

 Q0 and |Q0| =  0.000000  0.000000  0.200000  0.024493

 GPU acceleration is : ENABLED
 
 Algorithms used:
 - mtxel         : OPENACC_ALGO
 - chi_summation : OPENACC_ALGO
 
 You have a slightly shifted q0 vector and a semiconductor.
 So, reading from WFNq.
 Reading header of WFNq.h5
 Highest occupied band (shifted grid) = 1996
 Reading using H5FD_MPIO_INDEPENDENT.
 Using communication style:  1
 
 Summary of the WFN files:
 - Number of k-points in WFN: 1
 - Number of k-points in WFNq: 1
 - Number of k-points in the full BZ of WFN: 1

================================================================================
 06:12:33   Dealing with q =  0.000000  0.000000  0.200000                 1 / 1
================================================================================

 This is the special q->0 point.
 Rank of the polarizability matrix (nmtx): 51627
 
 BLACS processor grid:  16 x  16; BLOCKSIZE =   32
 
 Number of k-points in the irreducible BZ(q) (nrk): 1
 
 ========================================================
 == Start Building Polarizability Using:     5 Blocks. ==
 ========================================================
 
 Valence Block Number:     1 of     5 || Pass     1 of     1
 -----------------------------------------------------------
 
 Using GPU support via OpenACC/OMP-Target implementation
 Using batch implementation, batch size:    20
 
 Started calculation of matrix elements with 56 transition(s) at 06:12:35.
 [ 06:12:35 |   0% ] transition  1 / 56.
 [ 06:12:36 |   4% ] transition  3 / 56, remaining: 12 s.
 [ 06:12:37 |   9% ] transition  6 / 56, remaining: 11 s.
 [ 06:12:38 |  20% ] transition 12 / 56, remaining: 10 s.
 [ 06:12:39 |  29% ] transition 17 / 56, remaining: 9 s.
 [ 06:12:41 |  39% ] transition 23 / 56, remaining: 8 s.
 [ 06:12:42 |  48% ] transition 28 / 56, remaining: 6 s.
 [ 06:12:43 |  59% ] transition 34 / 56, remaining: 5 s.
 [ 06:12:44 |  70% ] transition 40 / 56, remaining: 4 s.
 [ 06:12:46 |  79% ] transition 45 / 56, remaining: 3 s.
 [ 06:12:47 |  89% ] transition 51 / 56, remaining: 1 s.
 [ 06:12:48 |  98% ] transition 56 / 56, remaining: 0 s.
 Finished calculation of matrix elements at 06:12:48.
 Elapsed time: 13 s.
 
 CHI summation GPU algorithm offloading all matrix elements to device.
 
 Started building polarizability matrix with 256 processor(s) at 06:12:50.
 [ 06:12:51 |   0% ] processor   1 / 256.
 [ 06:12:52 |   1% ] processor   3 / 256, remaining: 42 s.
 [ 06:12:56 |  10% ] processor  26 / 256, remaining: 38 s.
 [ 06:13:00 |  20% ] processor  52 / 256, remaining: 34 s.
 [ 06:13:04 |  30% ] processor  77 / 256, remaining: 30 s.
 [ 06:13:08 |  40% ] processor 103 / 256, remaining: 26 s.
 [ 06:13:13 |  50% ] processor 129 / 256, remaining: 22 s.
 [ 06:13:17 |  60% ] processor 154 / 256, remaining: 17 s.
 [ 06:13:22 |  70% ] processor 180 / 256, remaining: 13 s.
 [ 06:13:26 |  80% ] processor 205 / 256, remaining: 9 s.
 [ 06:13:30 |  90% ] processor 231 / 256, remaining: 4 s.
 Finished building polarizability matrix at 06:13:35.
 Elapsed time: 45 s.
 
 Done With Block Number:     1
 -----------------------------
 
 
 Valence Block Number:     2 of     5 || Pass     1 of     1
 -----------------------------------------------------------
 
 Using GPU support via OpenACC/OMP-Target implementation
 Using batch implementation, batch size:    20
 
 Started calculation of matrix elements with 56 transition(s) at 06:13:37.
 [ 06:13:37 |   0% ] transition  1 / 56.
 [ 06:13:38 |   4% ] transition  3 / 56, remaining: 12 s.
 [ 06:13:39 |   9% ] transition  6 / 56, remaining: 11 s.
 [ 06:13:40 |  20% ] transition 12 / 56, remaining: 10 s.
 [ 06:13:41 |  29% ] transition 17 / 56, remaining: 9 s.
 [ 06:13:42 |  39% ] transition 23 / 56, remaining: 7 s.
 [ 06:13:43 |  48% ] transition 28 / 56, remaining: 6 s.
 [ 06:13:45 |  59% ] transition 34 / 56, remaining: 5 s.
 [ 06:13:46 |  70% ] transition 40 / 56, remaining: 4 s.
 [ 06:13:47 |  79% ] transition 45 / 56, remaining: 3 s.
 [ 06:13:48 |  89% ] transition 51 / 56, remaining: 1 s.
 [ 06:13:50 |  98% ] transition 56 / 56, remaining: 0 s.
 Finished calculation of matrix elements at 06:13:50.
 Elapsed time: 13 s.
 
 CHI summation GPU algorithm offloading all matrix elements to device.
 
 Started building polarizability matrix with 256 processor(s) at 06:13:52.
 [ 06:13:53 |   0% ] processor   1 / 256.
 [ 06:13:54 |   1% ] processor   3 / 256, remaining: 43 s.
 [ 06:13:57 |  10% ] processor  26 / 256, remaining: 39 s.
 [ 06:14:02 |  20% ] processor  52 / 256, remaining: 34 s.
 [ 06:14:06 |  30% ] processor  77 / 256, remaining: 30 s.
 [ 06:14:11 |  40% ] processor 103 / 256, remaining: 26 s.
 [ 06:14:15 |  50% ] processor 129 / 256, remaining: 22 s.
 [ 06:14:19 |  60% ] processor 154 / 256, remaining: 18 s.
 [ 06:14:24 |  70% ] processor 180 / 256, remaining: 13 s.
 [ 06:14:28 |  80% ] processor 205 / 256, remaining: 9 s.
 [ 06:14:33 |  90% ] processor 231 / 256, remaining: 4 s.
 Finished building polarizability matrix at 06:14:37.
 Elapsed time: 46 s.
 
 Done With Block Number:     2
 -----------------------------
 
 
 Valence Block Number:     3 of     5 || Pass     1 of     1
 -----------------------------------------------------------
 
 Using GPU support via OpenACC/OMP-Target implementation
 Using batch implementation, batch size:    20
 
 Started calculation of matrix elements with 56 transition(s) at 06:14:39.
 [ 06:14:39 |   0% ] transition  1 / 56.
 [ 06:14:40 |   4% ] transition  3 / 56, remaining: 12 s.
 [ 06:14:41 |   9% ] transition  6 / 56, remaining: 11 s.
 [ 06:14:42 |  20% ] transition 12 / 56, remaining: 10 s.
 [ 06:14:44 |  29% ] transition 17 / 56, remaining: 9 s.
 [ 06:14:45 |  39% ] transition 23 / 56, remaining: 7 s.
 [ 06:14:46 |  48% ] transition 28 / 56, remaining: 6 s.
 [ 06:14:47 |  59% ] transition 34 / 56, remaining: 5 s.
 [ 06:14:49 |  70% ] transition 40 / 56, remaining: 4 s.
 [ 06:14:50 |  79% ] transition 45 / 56, remaining: 3 s.
 [ 06:14:51 |  89% ] transition 51 / 56, remaining: 1 s.
 [ 06:14:52 |  98% ] transition 56 / 56, remaining: 0 s.
 Finished calculation of matrix elements at 06:14:52.
 Elapsed time: 13 s.
 
 CHI summation GPU algorithm offloading all matrix elements to device.
 
 Started building polarizability matrix with 256 processor(s) at 06:14:55.
 [ 06:14:56 |   0% ] processor   1 / 256.
 [ 06:14:56 |   1% ] processor   3 / 256, remaining: 45 s.
 [ 06:15:00 |  10% ] processor  26 / 256, remaining: 39 s.
 [ 06:15:05 |  20% ] processor  52 / 256, remaining: 34 s.
 [ 06:15:09 |  30% ] processor  77 / 256, remaining: 30 s.
 [ 06:15:13 |  40% ] processor 103 / 256, remaining: 26 s.
 [ 06:15:18 |  50% ] processor 129 / 256, remaining: 22 s.
 [ 06:15:22 |  60% ] processor 154 / 256, remaining: 18 s.
 [ 06:15:27 |  70% ] processor 180 / 256, remaining: 13 s.
 [ 06:15:31 |  80% ] processor 205 / 256, remaining: 9 s.
 [ 06:15:36 |  90% ] processor 231 / 256, remaining: 4 s.
 Finished building polarizability matrix at 06:15:40.
 Elapsed time: 46 s.
 
 Done With Block Number:     3
 -----------------------------
 
 
 Valence Block Number:     4 of     5 || Pass     1 of     1
 -----------------------------------------------------------
 
 Using GPU support via OpenACC/OMP-Target implementation
 Using batch implementation, batch size:    20
 
 Started calculation of matrix elements with 56 transition(s) at 06:15:42.
 [ 06:15:42 |   0% ] transition  1 / 56.
 [ 06:15:44 |   4% ] transition  3 / 56, remaining: 12 s.
 [ 06:15:44 |   9% ] transition  6 / 56, remaining: 11 s.
 [ 06:15:46 |  20% ] transition 12 / 56, remaining: 10 s.
 [ 06:15:47 |  29% ] transition 17 / 56, remaining: 9 s.
 [ 06:15:48 |  39% ] transition 23 / 56, remaining: 7 s.
 [ 06:15:49 |  48% ] transition 28 / 56, remaining: 6 s.
 [ 06:15:50 |  59% ] transition 34 / 56, remaining: 5 s.
 [ 06:15:52 |  70% ] transition 40 / 56, remaining: 4 s.
 [ 06:15:53 |  79% ] transition 45 / 56, remaining: 3 s.
 [ 06:15:54 |  89% ] transition 51 / 56, remaining: 1 s.
 [ 06:15:55 |  98% ] transition 56 / 56, remaining: 0 s.
 Finished calculation of matrix elements at 06:15:55.
 Elapsed time: 13 s.
 
 CHI summation GPU algorithm offloading all matrix elements to device.
 
 Started building polarizability matrix with 256 processor(s) at 06:15:56.
 [ 06:15:58 |   0% ] processor   1 / 256.
 [ 06:15:58 |   1% ] processor   3 / 256, remaining: 44 s.
 [ 06:16:02 |  10% ] processor  26 / 256, remaining: 39 s.
 [ 06:16:07 |  20% ] processor  52 / 256, remaining: 34 s.
 [ 06:16:11 |  30% ] processor  77 / 256, remaining: 30 s.
 [ 06:16:15 |  40% ] processor 103 / 256, remaining: 26 s.
 [ 06:16:20 |  50% ] processor 129 / 256, remaining: 21 s.
 [ 06:16:24 |  60% ] processor 154 / 256, remaining: 17 s.
 [ 06:16:28 |  70% ] processor 180 / 256, remaining: 13 s.
 [ 06:16:32 |  80% ] processor 205 / 256, remaining: 9 s.
 [ 06:16:37 |  90% ] processor 231 / 256, remaining: 4 s.
 Finished building polarizability matrix at 06:16:41.
 Elapsed time: 44 s.
 
 Done With Block Number:     4
 -----------------------------
 
 
 Valence Block Number:     5 of     5 || Pass     1 of     1
 -----------------------------------------------------------
 
 Using GPU support via OpenACC/OMP-Target implementation
 Using batch implementation, batch size:    20
 
 Started calculation of matrix elements with 56 transition(s) at 06:16:43.
 [ 06:16:43 |   0% ] transition  1 / 56.
 [ 06:16:44 |   4% ] transition  3 / 56, remaining: 12 s.
 [ 06:16:44 |   9% ] transition  6 / 56, remaining: 11 s.
 [ 06:16:46 |  20% ] transition 12 / 56, remaining: 10 s.
 [ 06:16:47 |  29% ] transition 17 / 56, remaining: 9 s.
 [ 06:16:48 |  39% ] transition 23 / 56, remaining: 7 s.
 Finished calculation of matrix elements at 06:16:49.
 Elapsed time: 6 s.
 
 CHI summation GPU algorithm offloading all matrix elements to device.
 
 Started building polarizability matrix with 256 processor(s) at 06:16:51.
 [ 06:16:53 |   0% ] processor   1 / 256.
 [ 06:16:53 |   1% ] processor   3 / 256, remaining: 43 s.
 [ 06:16:57 |  10% ] processor  26 / 256, remaining: 38 s.
 [ 06:17:01 |  20% ] processor  52 / 256, remaining: 34 s.
 [ 06:17:06 |  30% ] processor  77 / 256, remaining: 30 s.
 [ 06:17:10 |  40% ] processor 103 / 256, remaining: 26 s.
 [ 06:17:14 |  50% ] processor 129 / 256, remaining: 21 s.
 [ 06:17:19 |  60% ] processor 154 / 256, remaining: 17 s.
 [ 06:17:23 |  70% ] processor 180 / 256, remaining: 13 s.
 [ 06:17:28 |  80% ] processor 205 / 256, remaining: 9 s.
 [ 06:17:32 |  90% ] processor 231 / 256, remaining: 4 s.
 Finished building polarizability matrix at 06:17:37.
 Elapsed time: 45 s.
 
 Done With Block Number:     5
 -----------------------------
 
 q-pt      1: Head of Epsilon         =     1.416652250097134E+01   -2.654939407267813E-18
 q-pt      1: Epsilon(2,2)            =     1.151002087971402E+01   -2.219536378394557E-18
 q-pt      1: Head of Epsilon Inverse =     7.899185187719437E-02    1.731371740134742E-20
 q-pt      1: Epsilon Inverse(2,2)    =     9.665226569824210E-02    2.167213204888933E-20
 
 For q0 points, you should check the symmetry (eps(G,G') = eps*(-G,-G')) by
 using the eps0sym code. Wavefunction convergence, as well as a finite q-shift
 may cause this property of eps(G,G') to be broken.

 Writing dielectric matrix to file
 Ok


********************************************************************************
*                                                                              *
* Your calculation employed methods and algorithms published in peer-reviewed  *
* papers. Please, cite the following references to give proper credit to their *
*          authors and help support future development of BerkeleyGW.          *
*                                                                              *
********************************************************************************

 J. Deslippe, G. Samsonidze, D. A. Strubbe, M. Jain, M. L. Cohen, and S. G.
 Louie, BerkeleyGW: A Massively Parallel Computer Package for the Calculation
 of the Quasiparticle and Optical Properties of Materials and Nanostructures,
 Computer Physics Communications 183, 1269 (2012).

 M. S. Hybertsen and S. G. Louie, Electron Correlation in Semiconductors and
 Insulators: Band Gaps and Quasiparticle Energies, Phys. Rev. B 34, 5390
 (1986).

 M. D. Ben, C. Yang, Z. Li, F. H. da Jornada, S. G. Louie, and J. Deslippe,
 Accelerating Large-Scale Excited-State GW Calculations on Leadership HPC
 Systems, SC20: International Conference for High Performance Computing,
 Networking, Storage and Analysis (2020).

********************************************************************************

 
 Timing information
 
                                CPU time (s)          WALL time (s)       Number
 Routine                       min        max        min        max     of calls
 -------------------------  ---------  ---------  ---------  ---------  --------
 - Eps (I/O) Comm                0.06       0.22       0.06       0.22         1
 - Eps (I/O) IO                 15.28      15.41      15.28      15.41         1
 - I/O TOTAL                    35.16      35.34      35.16      35.34         8
 - INPUT                        19.41      19.42      19.41      19.42         1
 - INPUT_Q                       3.49       3.58       3.49       3.58         1
 - FULLBZ                        0.00       0.00       0.00       0.00         1
 - GVEC                          0.00       0.01       0.00       0.01         1
 - SUBGRP                        0.00       0.00       0.00       0.00         1
 - IRRBZ                         0.00       0.00       0.00       0.00         1
 - GENWF                         2.78       3.89       2.79       3.90       250
 - MTXEL                        54.13      57.25      54.13      57.27       250
 - RQSTAR                        0.00       0.00       0.00       0.00         5
 - GMAP                          0.01       0.02       0.01       0.02         5
 - EPSINV (TOTAL)               55.42      57.33      55.42      57.33         1
 - CHI SUM (COMM)               32.03      46.75      32.00      46.76      3840
 - CHI SUM (TOTAL)             228.92     236.80     228.92     236.80         5
 - GENWF (VAL)                   0.42       0.46       0.42       0.47       250
 - GENWF (COND)                  2.36       3.42       2.35       3.42         5
 - EPSINV (VCOUL)                0.00       1.91       0.00       1.91         1
 - JOB SETUP                     0.07       0.15       0.07       0.15         1
 - Q LOOP SETUP                  0.01       0.01       0.01       0.01         1
 - INIT CUTOFF                   0.00       0.00       0.00       0.00         1
 - INIT SCALAPACK                0.02       0.02       0.02       0.02         1
 - INIT ARRAYS                   5.61       9.13       5.61       9.13         6
 - MTXEL (DENOM)                 0.25       0.29       0.19       0.33    213750
 - MTXEL (FFT)                  54.13      57.25      54.12      57.27       250
 - GENWF (Ekin)                  0.01       0.02       0.01       0.02        10
 - GENWF (Sort)                  0.07       0.07       0.07       0.07         2
 - CHI SUM (zGEMM)             116.51     127.70     116.51     127.68      1280
 - CHI SUM (PREP)               40.35      43.49      40.36      43.49      1280
 - CHI SUM (ARRAY ALLOC)         4.02       5.67       4.03       5.70      1280
 - EPSINV (I/O)                 15.58      15.59      15.58      15.59         1
 - EPSINV (INVERT)              39.20      39.22      39.20      39.22         1
 - CHI SUM (BAR)                 2.28      13.06       2.28      13.06         5
 - FFT MLTPLY                    5.10       6.37       5.05       6.44    213750
 - TOTAL                       384.24     384.25     384.24     384.25         1
 
 Job Done
 

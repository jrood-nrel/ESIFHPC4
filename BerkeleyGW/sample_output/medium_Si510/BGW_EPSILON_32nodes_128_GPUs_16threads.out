
 BerkeleyGW version 4.0+git 8511836-dirty by Jacob Clary <jacl0659@ed1.ib0.cm.hpc.nrel.gov> at 2024-03-13 16:03:19 -0600
 Epsilon code, Complex version, run on 31-Aug-2025 at 09:29:56 -0600

                                                                 ..o.          
                                                                .oxxo.         
                                                               .oxxxxo...      
                                                               oxxxxxxo.       
                                                              .oxxxxxxx.       
                                                              .ooooooxxo..     
                                                              .oooooooxo..     
                                                              .oooooxxo...     
                                                       .........oxooo......    
                                                 ............................  
                                             ................................. 
                                          .................................... 
           .          ..oo. ....  .................................oooxxxxxxxo.
     .............oxxxx@ox@@@x@x.....................o...........ooooooooooxx. 
    .o.........oox@x.oo........xxx@@............ooxxxxo..........ooooxxxxxoxo  
    .x........x@xxo...............o@xxo........oxxx@@@xoooooooooooooooxxxo...  
    .o......ox@@o..................oox@o.....ooxxx@xoooxxxxxxxoooooooooooo.... 
    o..ooooo@@xoooo....ooo...........x@o.....ooxxxxo   .oxxxxxxxxxxooooooo.... 
    . .oooo@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@....ooooox.     .oxx@@@@@xxoo........ 
      .ooooxxxxxxxooooooxooooooooooooooxo...oooooxx.        ..ox@xxxoo.........
      .ooooooxxxx@xoooooooooooooxxoooooooooooxxxxx.            .oxxooooooooxxo.
     .oooooxxxxx@@@xxxxxxxxxxxxxxxxxxxxxxxxoxxxxo.                .oxxxxxxxxo. 
   ....oooxxxxx@@@xo..oxxx@@@@@@xxxxoxxoooooooxx.                  .oxxxoo..   
  .....ooxxxx@@xo.       ........    .ooooooooxxo                              
  ..oooxxxx@@@o                       .oooooooxoo.                             
  ....oxooxxxxx.                       .ooo..oooo.                             
  .....o.ooxxxxxo.                     .oooooooxo.                             
 ......ooooxxxxxxo.                     .ooooooxoo..                           
........ooxxxxxxxo..                     .o....oxoo...                         
.......ooooxxxxxxxo.                     ........oooo.                         
.ooooooo..ooxxxxoooo.                    .........ooo...                       
..oxo...ooooxxxoooo..                    .ooo......oooo...                     
  .ooooo....o.                            .oxxxoo....ooo....                   
    .oooooo...                              ...ooooo...ooo..                   
       ...                                     .oo.......                      
                                               ....ooo...                      
                      __              __                                       
 ______              [  |            [  |                 ._____  _          _ 
|_   _               | |  _          | |                /  ___ | |        | |
  | |_) | .---.  _. _.| | / |  .---.  | | .---.  _    _ / /    _|   /  / / 
  |  __'./ /__\[ /`_| '' <  / /__\ | |/ /__\|   | | |   _____  /  / /  
 _| |__| | __. | |   | |`  | ___. | || ___.  / /  .___| |    /  /   
|_______/ .__./[_]  [__|  _] .__./[___].__./    /   .____./    /  /    
                                                  / /                          
                                                 /_/                           
 --------------------------------------------------------------------------------
 Please cite the main BerkeleyGW paper when using results from this calculation:

 Jack Deslippe, Georgy Samsonidze, David A. Strubbe, Manish Jain, Marvin L.
 Cohen, and Steven G. Louie, "BerkeleyGW: A Massively Parallel Computer Package
 for the Calculation of the Quasiparticle and Optical Properties of Materials
 and Nanostructures," Comput. Phys. Commun. 183, 1269 (2012)

 Aditionally, PLEASE CITE ALL PAPERS REPORTED AT THE END OF THIS CALCULATION.
 --------------------------------------------------------------------------------

 Running MPI version (parallel)
 Running with 128 MPI task(s)
 Using OpenMP. Number of threads per MPI task: 16
 Number of threads used for sorting routines: 1

 Compilation flags:
 - Compiler: NVHPC
 - Para. flags: MPI, OMP
 - Math  flags: USESCALAPACK, UNPACKED, USEFFTW3, HDF5
 - Debug flags: 

 Running with verbosity level 1 (default).

 We will start a new calculation from scratch.

 Experimental Features:
  - FFTs Optimization Level: 0
  - Use HDF5 Parallel IO: T

 
 We`ll perform a uniform sampling of the full BZ.
 
 Computing the static inverse dielectric matrix

 We are using matrix communication scheme

 We are using non-blocking cyclic communication scheme

 Using block algorithm over valence bands

 We are communicating via MPI

 We are using no truncation
 Reading header of WFN.h5
 Highest occupied band (unshifted grid) = 1020
 Valence max    (unshifted grid) = 6.235005 eV
 Conduction min (unshifted grid) = 6.617391 eV
 Middle energy  (unshifted grid) = 6.426198 eV
 Fermi  energy  (unshifted grid) = 6.426198 eV

 Reading header of WFNq.h5
 Highest occupied band (shifted grid) = 1020

 Calculation parameters:
 - Cutoff of the dielectric matrix (Ry): 8.00
 - Total number of bands in the calculation: 15045
 - Number of fully occupied valence bands: 1020
 - Number of partially occ. conduction bands: 0
 - Monkhorst-Pack q-grid for epsilon(q): 1 1 1
 
 Running with 4 valence pools
 Number of conduction bands per processor: 439
 Number of valence bands per processor: 255

 Memory available: 199856.4 MB per PE
 Memory required for execution: 40594.8 MB per PE
 Memory required for vcoul: 0.0 MB per PE

 Valence block alogorithm info
 Max memory allowed per valence block (Gb):    80.00
 Memory for a single valence band (Gb):         0.37
 Number of valence bands per block:             214

 Number of electrons per unit cell (from ifmax) = 2040.000000
 Number of electrons per unit cell (from occupations) = 2040.000000
 Plasma Frequency = 1.217761 Ry

 Reading using H5FD_MPIO_INDEPENDENT.
 Using communication style:  1
 
 Reading using H5FD_MPIO_INDEPENDENT.
 Using communication style:  1
 
 Initializing eps0mat.h5
 - Screened Coulomb cutoff: 8.000 Ry
 - Total number of bands: 15045
 - Number of q-points: 1

 Scissors parameters:
 - Valence:    es =   0.0000 eV, e0 =   0.0000 eV, edel =   0.0000
 - Conduction: es =   0.0000 eV, e0 =   0.0000 eV, edel =   0.0000

 Q0 and |Q0| =  0.000000  0.000000  0.100000  0.015308

 GPU acceleration is : ENABLED
 
 Algorithms used:
 - mtxel         : OPENACC_ALGO
 - chi_summation : OPENACC_ALGO
 
 You have a slightly shifted q0 vector and a semiconductor.
 So, reading from WFNq.
 Reading header of WFNq.h5
 Highest occupied band (shifted grid) = 1020
 Reading using H5FD_MPIO_INDEPENDENT.
 Using communication style:  1
 
 Summary of the WFN files:
 - Number of k-points in WFN: 1
 - Number of k-points in WFNq: 1
 - Number of k-points in the full BZ of WFN: 1

================================================================================
 09:30:01   Dealing with q =  0.000000  0.000000  0.100000                 1 / 1
================================================================================

 This is the special q->0 point.
 Rank of the polarizability matrix (nmtx): 26529
 
 BLACS processor grid:   8 x  16; BLOCKSIZE =   32
 
 Number of k-points in the irreducible BZ(q) (nrk): 1
 
 ========================================================
 == Start Building Polarizability Using:     2 Blocks. ==
 ========================================================
 
 Valence Block Number:     1 of     2 || Pass     1 of     1
 -----------------------------------------------------------
 
 Using GPU support via OpenACC/OMP-Target implementation
 Using batch implementation, batch size:    20
 
 Started calculation of matrix elements with 214 transition(s) at 09:30:04.
 [ 09:30:04 |   0% ] transition   1 / 214.
 [ 09:30:04 |   1% ] transition   3 / 214, remaining: 13 s.
 [ 09:30:05 |  10% ] transition  22 / 214, remaining: 11 s.
 [ 09:30:07 |  20% ] transition  43 / 214, remaining: 10 s.
 [ 09:30:08 |  30% ] transition  65 / 214, remaining: 9 s.
 [ 09:30:09 |  40% ] transition  86 / 214, remaining: 8 s.
 [ 09:30:10 |  50% ] transition 107 / 214, remaining: 6 s.
 [ 09:30:12 |  60% ] transition 129 / 214, remaining: 5 s.
 [ 09:30:13 |  70% ] transition 150 / 214, remaining: 4 s.
 [ 09:30:14 |  80% ] transition 172 / 214, remaining: 3 s.
 [ 09:30:16 |  90% ] transition 193 / 214, remaining: 1 s.
 [ 09:30:17 | 100% ] transition 214 / 214, remaining: 0 s.
 Finished calculation of matrix elements at 09:30:17.
 Elapsed time: 13 s.
 
 CHI summation GPU algorithm offloading all matrix elements to device.
 
 Started building polarizability matrix with 128 processor(s) at 09:30:17.
 [ 09:30:19 |   0% ] processor   1 / 128.
 [ 09:30:19 |   2% ] processor   3 / 128, remaining: 24 s.
 [ 09:30:21 |   9% ] processor  13 / 128, remaining: 22 s.
 [ 09:30:24 |  20% ] processor  26 / 128, remaining: 20 s.
 [ 09:30:26 |  30% ] processor  39 / 128, remaining: 17 s.
 [ 09:30:29 |  40% ] processor  52 / 128, remaining: 15 s.
 [ 09:30:31 |  50% ] processor  65 / 128, remaining: 12 s.
 [ 09:30:34 |  59% ] processor  77 / 128, remaining: 10 s.
 [ 09:30:36 |  70% ] processor  90 / 128, remaining: 8 s.
 [ 09:30:39 |  80% ] processor 103 / 128, remaining: 5 s.
 [ 09:30:41 |  90% ] processor 116 / 128, remaining: 3 s.
 Finished building polarizability matrix at 09:30:44.
 Elapsed time: 26 s.
 
 Done With Block Number:     1
 -----------------------------
 
 
 Valence Block Number:     2 of     2 || Pass     1 of     1
 -----------------------------------------------------------
 
 Using GPU support via OpenACC/OMP-Target implementation
 Using batch implementation, batch size:    20
 
 Started calculation of matrix elements with 214 transition(s) at 09:30:47.
 [ 09:30:47 |   0% ] transition   1 / 214.
 [ 09:30:47 |   1% ] transition   3 / 214, remaining: 13 s.
 [ 09:30:48 |  10% ] transition  22 / 214, remaining: 11 s.
 Finished calculation of matrix elements at 09:30:49.
 Elapsed time: 3 s.
 
 CHI summation GPU algorithm offloading all matrix elements to device.
 
 Started building polarizability matrix with 128 processor(s) at 09:30:49.
 [ 09:30:51 |   0% ] processor   1 / 128.
 [ 09:30:51 |   2% ] processor   3 / 128, remaining: 23 s.
 [ 09:30:53 |   9% ] processor  13 / 128, remaining: 22 s.
 [ 09:30:56 |  20% ] processor  26 / 128, remaining: 20 s.
 [ 09:30:58 |  30% ] processor  39 / 128, remaining: 17 s.
 [ 09:31:01 |  40% ] processor  52 / 128, remaining: 15 s.
 [ 09:31:03 |  50% ] processor  65 / 128, remaining: 12 s.
 [ 09:31:05 |  59% ] processor  77 / 128, remaining: 10 s.
 [ 09:31:08 |  70% ] processor  90 / 128, remaining: 7 s.
 [ 09:31:10 |  80% ] processor 103 / 128, remaining: 5 s.
 [ 09:31:13 |  90% ] processor 116 / 128, remaining: 2 s.
 Finished building polarizability matrix at 09:31:15.
 Elapsed time: 26 s.
 
 Done With Block Number:     2
 -----------------------------
 
 q-pt      1: Head of Epsilon         =     1.524681719435079E+01   -4.460184757187222E-17
 q-pt      1: Epsilon(2,2)            =     1.070898941170525E+01   -1.588552294222483E-17
 q-pt      1: Head of Epsilon Inverse =     7.338597034593267E-02    2.473906341128527E-19
 q-pt      1: Epsilon Inverse(2,2)    =     1.037812739896419E-01    1.664812376864761E-19
 
 For q0 points, you should check the symmetry (eps(G,G') = eps*(-G,-G')) by
 using the eps0sym code. Wavefunction convergence, as well as a finite q-shift
 may cause this property of eps(G,G') to be broken.

 Writing dielectric matrix to file
 Ok


********************************************************************************
*                                                                              *
* Your calculation employed methods and algorithms published in peer-reviewed  *
* papers. Please, cite the following references to give proper credit to their *
*          authors and help support future development of BerkeleyGW.          *
*                                                                              *
********************************************************************************

 J. Deslippe, G. Samsonidze, D. A. Strubbe, M. Jain, M. L. Cohen, and S. G.
 Louie, BerkeleyGW: A Massively Parallel Computer Package for the Calculation
 of the Quasiparticle and Optical Properties of Materials and Nanostructures,
 Computer Physics Communications 183, 1269 (2012).

 M. S. Hybertsen and S. G. Louie, Electron Correlation in Semiconductors and
 Insulators: Band Gaps and Quasiparticle Energies, Phys. Rev. B 34, 5390
 (1986).

 M. D. Ben, C. Yang, Z. Li, F. H. da Jornada, S. G. Louie, and J. Deslippe,
 Accelerating Large-Scale Excited-State GW Calculations on Leadership HPC
 Systems, SC20: International Conference for High Performance Computing,
 Networking, Storage and Analysis (2020).

********************************************************************************

 
 Timing information
 
                                CPU time (s)          WALL time (s)       Number
 Routine                       min        max        min        max     of calls
 -------------------------  ---------  ---------  ---------  ---------  --------
 - Eps (I/O) Comm                0.01       0.08       0.01       0.08         1
 - Eps (I/O) IO                  6.52       6.53       6.52       6.53         1
 - I/O TOTAL                     9.85       9.95       9.85       9.95         8
 - INPUT                         2.71       2.73       2.71       2.73         1
 - INPUT_Q                       1.44       1.54       1.44       1.54         1
 - FULLBZ                        0.00       0.00       0.00       0.00         1
 - GVEC                          0.00       0.00       0.00       0.00         1
 - SUBGRP                        0.00       0.00       0.00       0.00         1
 - IRRBZ                         0.00       0.00       0.00       0.00         1
 - GENWF                         0.42       0.54       0.41       0.53       255
 - MTXEL                        14.29      15.61      14.29      15.61       255
 - RQSTAR                        0.00       0.00       0.00       0.00         2
 - GMAP                          0.00       0.00       0.00       0.00         2
 - EPSINV (TOTAL)               16.08      16.73      16.08      16.73         1
 - CHI SUM (COMM)                3.59       6.68       3.59       6.70       768
 - CHI SUM (TOTAL)              52.59      54.40      52.59      54.40         2
 - GENWF (VAL)                   0.17       0.18       0.15       0.20       255
 - GENWF (COND)                  0.24       0.35       0.24       0.35         2
 - EPSINV (VCOUL)                0.00       0.65       0.00       0.65         1
 - JOB SETUP                     0.00       0.02       0.00       0.02         1
 - Q LOOP SETUP                  0.00       0.00       0.00       0.00         1
 - INIT CUTOFF                   0.00       0.00       0.00       0.00         1
 - INIT SCALAPACK                0.01       0.01       0.01       0.01         1
 - INIT ARRAYS                   3.01       3.63       3.01       3.63         3
 - MTXEL (DENOM)                 0.12       0.15       0.10       0.17    111945
 - MTXEL (FFT)                  14.29      15.61      14.29      15.61       255
 - GENWF (Ekin)                  0.00       0.00       0.00       0.01         4
 - GENWF (Sort)                  0.03       0.03       0.03       0.03         2
 - CHI SUM (zGEMM)              26.58      29.06      26.59      29.06       256
 - CHI SUM (PREP)               13.34      13.84      13.35      13.85       256
 - CHI SUM (ARRAY ALLOC)         0.83       0.84       0.82       0.86       256
 - EPSINV (I/O)                  6.60       6.61       6.60       6.61         1
 - EPSINV (INVERT)               9.15       9.15       9.15       9.15         1
 - CHI SUM (BAR)                 0.08       1.95       0.08       1.95         2
 - FFT MLTPLY                    2.06       2.62       2.11       2.62    111945
 - TOTAL                        95.79      95.80      95.79      95.80         1
 
 Job Done
 
